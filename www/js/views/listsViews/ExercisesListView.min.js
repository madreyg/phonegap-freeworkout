define(["jquery","underscore","backbone","./LayoutListView","text!../../../templates/exercisesList.html","text!../../../templates/exercisesFilter.html"],function(a,b,c,d,e,f){var g=d.extend({template:b.template(e),events:{"click .exercises":"exercises"},initialize:function(){d.prototype.initialize.apply(this),a("#filter-btn-header").show(),a("#filterpanel").children().remove(),a("#filterpanel").html(f).trigger("create"),this.initFilter()},exercises:function(b){var c=a(b.currentTarget).attr("href");a.mobile.navigate(c,!0)},applyFilter:function(b){b.preventDefault(),b.stopPropagation(),window.localStorage.setItem("exercise_trainer",a("#filter-trainer").val()),window.localStorage.setItem("muscle",a("#filter-muscle").val()),a("#filterpanel").panel("close"),a(".exerciseslist").children().remove(),a(".exerciseslist").remove(),this.collection.fltr={page:1},this.collection.fetch({reset:!0})},initFilter:function(){var b=this;a("#filterpanel").on("panelbeforeopen",function(b,c){a.when(a.ajax("http://free-workout.ru/workout/api/muscles/"),a.ajax("http://free-workout.ru/workout/api/trainers/")).then(function(b,c){var d=a("#filter-trainer");a.each(c[0],function(a,b){d.append('<option value="'+b.id+'">'+b.name+"</option>")}),d.val(window.localStorage.getItem("exercise_trainer")||"").attr("selected",!0).siblings("option").removeAttr("selected"),d.selectmenu("refresh");var e=a("#filter-muscle");a.each(b[0],function(a,b){e.append('<option value="'+b.id+'">'+b.name+"</option>")}),e.val(window.localStorage.getItem("muscle")||"").attr("selected",!0).siblings("option").removeAttr("selected"),e.selectmenu("refresh")})}),a("#filter-submit").bind("vclick",function(a){return b.applyFilter(a),!1})}});return g});